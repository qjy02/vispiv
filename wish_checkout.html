<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="icon"
      href="Vispiv.png"
      type="image/png"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito:wght@600&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <title>Wishlist and Checkout List</title>
    <style>
      body {
        font-family: "Quicksand", Verdana, sans-serif;
        margin: 20px;
        background-color: #2c3e50;
      }

      .container {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        width: 100%;
      }

      .list {
        width: 45%;
        border: 1px solid #ccc;
        padding: 20px;
        border-radius: 10px;
        background-color: #34495e;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        position: relative;
      }

      .list h3 {
        text-align: center;
        color: #fff;
        flex: 1; /* Allow the heading to take up remaining space */
        text-align: center; /* Center the heading text */
        vertical-align: center;
      }

      .card {
        padding: 10px;
        margin: 10px 0;
        border-radius: 8px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-family: "Quicksand", Verdana, sans-serif;
        font-weight: 600;
        background-color: #e0f7fa;
        transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
      }

      .card:active {
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .card button {
        padding: 5px 10px;
        background-color: #007bff;
        color: white;
        font-family: "Quicksand", Verdana, sans-serif;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .card button.remove-btn {
        background-color: transparent;
        font-family: "Quicksand", Verdana, sans-serif;
        color: #fff;
        border: none;
      }

      .card button.remove-btn:hover {
        background-color: transparent;
        cursor: pointer;
      }

      .card button:hover {
        background-color: #0056b3;
      }

      .card button.remove {
        background-color: #dc3545;
      }

      .card button.remove:hover {
        background-color: #c82333;
      }

      .card p {
        margin: 0;
        color: #333;
      }

      #scrollToTopBtn {
        display: none;
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 9999;
        background: linear-gradient(135deg, #1a3a6d, #2e5a9a);
        border: 1px solid #203454;
        color: white;
        border-radius: 10px;
        width: 35px;
        height: 35px;
        font-size: 20px;
        cursor: pointer;
        outline: none;
        box-shadow: 3px 3px 5px #203454, -1px -1px 2px rgba(0, 0, 0, 0.2);
        transition: all 0.2s ease-in-out;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      #scrollToTopBtn:hover {
        background: linear-gradient(135deg, #204a7d, #3b6db1);
        box-shadow: 4px 4px 6px #1a2c4a, -1px -1px 2px rgba(0, 0, 0, 0.3);
        transform: translateY(-2px);
      }

      #scrollToTopBtn:active {
        transform: translateY(2px);
        box-shadow: inset 2px 2px 4px #1a2c4a;
      }

      #scrollToTopBtn::before {
        content: "\2B06";
      }

      /* Form styling */
      .add-item-form {
        margin-bottom: 20px;
        text-align: center;
      }

      .add-item-form input {
        padding: 10px;

        border: none;
        border-radius: 5px;
        margin-right: 10px;
        font-size: 14px;
        outline: none;
        border: 2px solid darkgrey;
        border-radius: 5px;
        box-shadow: 3px 3px 2px 0px #e2e2e2;
        transition: 0.3s ease;
        width: 300px;
      }

      .add-item-form input:focus {
        background: #f2f2f2;
        border: 1px solid darkgrey;
        border-radius: 10px;
      }

      .add-item-form button {
        padding: 10px 20px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      .add-item-form button:hover {
        background-color: #218838;
      }

      .header {
        display: flex;
        vertical-align: center;
        text-align: center;
        align-items: center; /* Center the items vertically */
      }

      .export-buttons {
        display: flex; /* Align buttons horizontally */
      }

      .export-btn {
        background-color: transparent;
        font-family: "Quicksand", Verdana, sans-serif;
        color: #fff;
        border: none;
        cursor: pointer;
        margin-left: 10px; /* Space between buttons */
      }

      .export-btn i {
        font-size: 20px;
        color: #fff;
      }

      .addtowishlist {
        background-color: #0c5836 !important;
        font-family: "Quicksand", Verdana, sans-serif;
        color: white;
        border: 2px solid darkgreen;
        border-radius: 8px;
        font-weight: 600;
        padding: 12px 24px;
        font-size: 15px;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      .addtowishlist:hover {
        background-color: #45a049;
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
      }

      .addtowishlist:active {
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        text-align: center;
        vertical-align: center;
        background-color: #34495e;
        padding: 10px 20px;
        border-radius: 10px;
      }
      .navbar a {
        color: white;
        text-decoration: none;
        padding: 10px;
        font-weight: bold;
      }
      .navbar a:hover {
        background-color: #007bff;
        border-radius: 5px;
      }
      .navbar .menu-icon {
        display: none;
        font-size: 24px;
        cursor: pointer;
        color: white;
      }
      .navbar-links {
        display: flex;
        gap: 15px;
      }

      .navbar a.active {
        background-color: #04366d;
        border-radius: 5px;
      }
      @media (max-width: 1000px) {
        .navbar .vispiv-container {
          display: flex;
        }
        .navbar-links {
          display: none;
          flex-direction: column;
          width: 100%;
        }

        .navbar .menu-icon {
          display: block;
        }

        .navbar.active .navbar-links {
          display: grid;
        }

        .navbar.active .vispiv-container {
          display: none;
        }
      }
      .vispiv-container {
        display: flex;
        align-items: center;
        font-weight: 600;
        color: #fff;
        margin-left: 5px;
      }

      .vispiv-container a:hover {
        background: none;
        border-radius: 0;
      }

      .vispiv-icon {
        margin-right: 10px;
        width: 60px;
        height: auto;
      }

      #itemName::placeholder {
        font-family: "Quicksand", Verdana, sans-serif;
      }

      #itemPrice::placeholder {
        font-family: "Quicksand", Verdana, sans-serif;
      }

      @media (max-width: 920px) {
        .container {
          flex-direction: column;
          align-items: center;
        }

        .list {
          width: 90%;
          margin-bottom: 20px;
        }

        #scrollToTopBtn {
          width: 40px;
          height: 40px;
          font-size: 20px;
        }

        .add-item-form {
          display: flex;
          flex-direction: column;
          align-items: center;
        }

        .add-item-form input,
        .add-item-form button {
          width: 90%;
          margin: 5px 0;
        }

        .add-item-form button {
          width: 95%;
        }
      }
    </style>
  </head>
  <body>
    <div class="navbar">
      <div class="navbar-links">
        <a href="jsonformatter.html">Json Formatter</a>
        <a href="jsongrid.html">Json2Grid</a>
        <a href="datafixer.html">Data Fixer</a>
        <a href="text_viewer_pdf.html">Text File Viewer</a>
        <a href="qrcodereader.html">QR Code Reader</a>
        <a href="calendar_view.html">Vispiv Calendar</a>
        <a href="diffchecker.html">Diff Checker</a>
        <a href="wish_checkout.html" class="active"
          >Wishlist and Checkout List</a
        >
      </div>

      <div>
        <div class="vispiv-container">
          <a href="list.html" style="text-decoration: none">
            <img
              src="Vispiv.png"
              alt="Vispiv Icon"
              class="vispiv-icon"
            />
          </a>
          <span>Vispiv Help Tools</span>
        </div>
      </div>
      <i class="fas fa-bars menu-icon" onclick="toggleMenu()"></i>
    </div>

    <div class="add-item-form">
      <h3 style="color: #fff">🌿Wishlist and Checkout🌿</h3>
      <input type="text" id="itemName" placeholder="Item Description" />
      <input type="number" id="itemPrice" placeholder="Item Price" />
      <button class="addtowishlist" onclick="addNewItem()">
        Add to Wishlist
      </button>
    </div>

    <div
      style="
        margin-top: 20px;
        margin-bottom: 10px;
        text-align: right;
        vertical-align: right;
      "
    >
      <button class="export-btn" onclick="exportAllToExcel()">
        🧾 Export All (Excel)
      </button>
      <button class="export-btn" onclick="exportAllToWord()">
        📄 Export All (Word)
      </button>
    </div>

    <div class="container">
      <div class="list" id="wishlist">
        <div class="header">
          <h3>📜Wishlist📜</h3>
          <div class="export-buttons">
            <button class="export-btn" onclick="exportWishlistToExcel()">
              🧾Excel
            </button>
            <button class="export-btn" onclick="exportWishlistToWord()">
              📄Word
            </button>
          </div>
        </div>
      </div>

      <div class="list" id="checkout">
        <div class="header">
          <h3>🛒Checkout🛒</h3>
          <div class="export-buttons">
            <button class="export-btn" onclick="exportCheckoutToExcel()">
              🧾Excel
            </button>
            <button class="export-btn" onclick="exportCheckoutToWord()">
              📄Word
            </button>
          </div>
        </div>

        <div id="checkoutItems" style="text-align: left"></div>

        <div style="text-align: right; vertical-align: right">
          <span style="color: #fff; font-weight: 600"
            >Total: RM <span id="totalPrice">0.00</span></span
          >
        </div>
      </div>

      <button
        onclick="scrollToTop()"
        id="scrollToTopBtn"
        title="Go to top"
      ></button>
    </div>

    <div style="margin-top: 20px">
      <footer style="text-align: center; color: white;">
        <span>Copyright © 2024 Vispiv Collectives</span>
      </footer>
    </div>

    <script>
      let totalCheckoutPrice = 0;

      document
        .getElementById("itemName")
        .addEventListener("keypress", function (event) {
          if (event.key === "Enter") {
            event.preventDefault();
            addNewItem();
          }
        });

      document
        .getElementById("itemPrice")
        .addEventListener("keypress", function (event) {
          if (event.key === "Enter") {
            event.preventDefault();
            addNewItem();
          }
        });

      function generateRandomId() {
        const randomDigits = Math.floor(
          100000000 + Math.random() * 900000000
        ).toString();
        return `v${randomDigits}`;
      }

      function addToCheckout(itemName, price, itemId) {
        const checkout = document.getElementById("checkoutItems");
        const wishlistItem = document.getElementById(itemId);

        const itemDiv = document.createElement("div");
        itemDiv.classList.add("card");
        itemDiv.setAttribute("id", itemId);

        price = parseFloat(price);
        const formattedPrice = isNaN(price)
          ? "RM 0.00"
          : `RM ${price.toFixed(2)}`;

        itemDiv.innerHTML = `<p>${itemName} - ${formattedPrice}</p><button class="remove" onclick="removeFromCheckout('${itemName}', ${price}, '${itemId}')">Remove</button>`;

        checkout.appendChild(itemDiv);
        wishlistItem.remove();

        updateTotal(price);
      }

      function removeFromCheckout(itemName, price, itemId) {
        const wishlist = document.getElementById("wishlist");
        const checkoutItem = event.target.closest(".card");

        updateTotal(-price);

        const itemDiv = document.createElement("div");
        itemDiv.classList.add("card");
        itemDiv.setAttribute("id", itemId);

        price = parseFloat(price);
        const formattedPrice = isNaN(price)
          ? "RM 0.00"
          : `RM ${price.toFixed(2)}`;

        itemDiv.innerHTML = `
          <p>${itemName} - ${formattedPrice}</p>
          <div style="display: flex; gap: 0px;">
            <button onclick="addToCheckout('${itemName}', ${price}, '${itemId}')">Add to Checkout</button>
            <button class="remove-btn" onclick="removeFromWishlist('${itemId}')">❌</button>
          </div>
        `;

        wishlist.appendChild(itemDiv);
        checkoutItem.remove();
      }

      function updateTotal(amount) {
        totalCheckoutPrice += amount;
        document.getElementById("totalPrice").innerText =
          totalCheckoutPrice.toFixed(2);
      }

      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: "auto",
        });
      }

      window.onscroll = function () {
        scrollFunction();
      };

      function scrollFunction() {
        if (
          document.body.scrollTop > 20 ||
          document.documentElement.scrollTop > 20
        ) {
          document.getElementById("scrollToTopBtn").style.display = "block";
        } else {
          document.getElementById("scrollToTopBtn").style.display = "none";
        }
      }

      function addNewItem() {
        const itemName = document.getElementById("itemName").value;
        let itemPrice = document.getElementById("itemPrice").value;

        if (itemName === "" || itemPrice === "") {
          alert("Please enter both item name and price.");
          return;
        }

        itemPrice = parseFloat(itemPrice).toFixed(2);
        const itemId = generateRandomId();
        const wishlist = document.getElementById("wishlist");

        const itemDiv = document.createElement("div");
        itemDiv.classList.add("card");
        itemDiv.setAttribute("id", itemId);
        itemDiv.innerHTML = `
          <p>${itemName} - RM ${itemPrice}</p>
          <div style="display: flex; gap: 0px;">
            <button onclick="addToCheckout('${itemName}', ${itemPrice}, '${itemId}')">Add to Checkout</button>
            <button class="remove-btn" onclick="removeFromWishlist('${itemId}')">❌</button>
          </div>
        `;

        wishlist.appendChild(itemDiv);

        document.getElementById("itemName").value = "";
        document.getElementById("itemPrice").value = "";
      }

      function removeFromWishlist(itemId) {
        const item = document.getElementById(itemId);
        if (item) {
          item.remove();
        } else {
          alert("Item not found in the wishlist.");
        }
      }

      function exportWishlistToExcel() {
        const wishlist = document.querySelectorAll("#wishlist .card");
        if (wishlist.length === 0) {
          alert("No items in wishlist to export.");
          return;
        }

        const data = [["Item ID", "Item Name", "Price"]];
        wishlist.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const price =
            "RM " + item.querySelector("p").textContent.split("RM")[1].trim();
          data.push([itemId, itemName, price]);
        });

        const totalPrice = data.slice(1).reduce((acc, row) => {
          const price = parseFloat(row[2].replace("RM ", "").replace(",", ""));
          return acc + (isNaN(price) ? 0 : price);
        }, 0);

        data.push([
          "",
          "Estimated Total Amount",
          `RM ${totalPrice.toFixed(2)}`,
        ]);

        const worksheet = XLSX.utils.aoa_to_sheet(data);

        Object.keys(worksheet).forEach((cell) => {
          if (!cell.startsWith("!")) {
            worksheet[cell].s = {
              alignment: { horizontal: "center", vertical: "center" },
            };
          }
        });

        const colWidths = data[0].map((_, colIndex) => ({
          wch:
            Math.max(
              ...data.map((row) =>
                row[colIndex] ? row[colIndex].toString().length : 0
              )
            ) + 5,
        }));
        worksheet["!cols"] = colWidths;

        worksheet["!autofilter"] = { ref: `A1:C${data.length}` };

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "wishlist");

        XLSX.writeFile(workbook, "wishlist.xlsx");
      }

      function exportCheckoutToExcel() {
        const checkout = document.querySelectorAll("#checkout .card");
        if (checkout.length === 0) {
          alert("No items in checkout to export.");
          return;
        }

        const data = [["Item ID", "Item Name", "Price"]];
        checkout.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const price =
            "RM " + item.querySelector("p").textContent.split("RM")[1].trim();
          data.push([itemId, itemName, price]);
        });

        const totalPrice = data.slice(1).reduce((acc, row) => {
          const price = parseFloat(row[2].replace("RM ", "").replace(",", ""));
          return acc + (isNaN(price) ? 0 : price);
        }, 0);

        data.push([
          "",
          "Estimated Total Amount",
          `RM ${totalPrice.toFixed(2)}`,
        ]);

        const worksheet = XLSX.utils.aoa_to_sheet(data);

        Object.keys(worksheet).forEach((cell) => {
          if (!cell.startsWith("!")) {
            worksheet[cell].s = {
              alignment: { horizontal: "center", vertical: "center" },
            };
          }
        });

        const colWidths = data[0].map((_, colIndex) => ({
          wch:
            Math.max(
              ...data.map((row) =>
                row[colIndex] ? row[colIndex].toString().length : 0
              )
            ) + 5,
        }));
        worksheet["!cols"] = colWidths;

        worksheet["!autofilter"] = { ref: `A1:C${data.length}` };

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "checkout");

        XLSX.writeFile(workbook, "checkout.xlsx");
      }

      function exportWishlistToWord() {
        const wishlist = document.querySelectorAll("#wishlist .card");
        if (wishlist.length === 0) {
          alert("No items in wishlist to export.");
          return;
        }

        let content =
          "<h3>Title: Wishlist</h3><table border='1'><tr><th>Item ID</th><th>Item Name</th><th>Price</th></tr>";
        wishlist.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const rawPrice = parseFloat(
            item.querySelector("p").textContent.split("RM")[1].trim()
          );
          const formattedPrice = isNaN(rawPrice)
            ? "RM 0.00"
            : `RM ${rawPrice.toFixed(2)}`;

          content += `<tr><td>${itemId}</td><td>${itemName}</td><td>${formattedPrice}</td></tr>`;
        });

        const totalPrice = [...wishlist].reduce((acc, item) => {
          const price = parseFloat(
            item.querySelector("p").textContent.split("RM")[1].trim()
          );
          return acc + (isNaN(price) ? 0 : price);
        }, 0);

        content += `<tr><td colspan="2">Estimated Total Amount</td><td>RM ${totalPrice.toFixed(
          2
        )}</td></tr>`;
        content += "</table>";

        const blob = new Blob([content], { type: "application/msword" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "wishlist.doc";
        a.click();
        URL.revokeObjectURL(url);
      }

      function exportCheckoutToWord() {
        const checkout = document.querySelectorAll("#checkout .card");
        if (checkout.length === 0) {
          alert("No items in checkout to export.");
          return;
        }

        let content =
          "<h3>Title: Checkout</h3><table border='1'><tr><th>Item ID</th><th>Item Name</th><th>Price</th></tr>";
        checkout.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const rawPrice = parseFloat(
            item.querySelector("p").textContent.split("RM")[1].trim()
          );
          const formattedPrice = isNaN(rawPrice)
            ? "RM 0.00"
            : `RM ${rawPrice.toFixed(2)}`;

          content += `<tr><td>${itemId}</td><td>${itemName}</td><td>${formattedPrice}</td></tr>`;
        });

        const totalPrice = [...checkout].reduce((acc, item) => {
          const price = parseFloat(
            item.querySelector("p").textContent.split("RM")[1].trim()
          );
          return acc + (isNaN(price) ? 0 : price);
        }, 0);

        content += `<tr><td colspan="2">Estimated Total Amount</td><td>RM ${totalPrice.toFixed(
          2
        )}</td></tr>`;
        content += "</table>";

        const blob = new Blob([content], { type: "application/msword" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "checkout.doc";
        a.click();
        URL.revokeObjectURL(url);
      }

      function exportAllToExcel() {
        const wishlist = document.querySelectorAll("#wishlist .card");
        const checkout = document.querySelectorAll("#checkout .card");
        if (wishlist.length === 0 && checkout.length === 0) {
          alert("No items in wishlist or checkout to export.");
          return;
        }

        const data = [["Item ID", "Item Name", "Price", "Type"]];

        wishlist.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const price =
            "RM " + item.querySelector("p").textContent.split("RM")[1].trim();
          data.push([itemId, itemName, price, "Wishlist"]);
        });

        checkout.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const price =
            "RM " + item.querySelector("p").textContent.split("RM")[1].trim();
          data.push([itemId, itemName, price, "Checkout"]);
        });

        const totalPrice = data.slice(1).reduce((acc, row) => {
          const price = parseFloat(row[2].replace("RM ", "").replace(",", ""));
          return acc + (isNaN(price) ? 0 : price);
        }, 0);

        data.push([
          "",
          "Estimated Total Amount",
          `RM ${totalPrice.toFixed(2)}`,
          "Total",
        ]);

        const worksheet = XLSX.utils.aoa_to_sheet(data);

        Object.keys(worksheet).forEach((cell) => {
          if (!cell.startsWith("!")) {
            worksheet[cell].s = {
              alignment: { horizontal: "center", vertical: "center" },
            };
          }
        });

        const colWidths = data[0].map((_, colIndex) => ({
          wch:
            Math.max(
              ...data.map((row) =>
                row[colIndex] ? row[colIndex].toString().length : 0
              )
            ) + 5,
        }));
        worksheet["!cols"] = colWidths;

        worksheet["!autofilter"] = { ref: `A1:D${data.length}` };

        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "wishlist_checkout");

        XLSX.writeFile(workbook, "wishlist_checkout.xlsx");
      }

      function exportAllToWord() {
        const wishlist = document.querySelectorAll("#wishlist .card");
        const checkout = document.querySelectorAll("#checkout .card");

        if (wishlist.length === 0 && checkout.length === 0) {
          alert("No items in wishlist or checkout to export.");
          return;
        }

        let content =
          "<h3>Title: Wishlist and Checkout</h3><table border='1'><tr><th>Item ID</th><th>Item Name</th><th>Price</th><th>Type</th></tr>";

        wishlist.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const rawPrice = parseFloat(
            item.querySelector("p").textContent.split("RM")[1].trim()
          );
          const formattedPrice = isNaN(rawPrice)
            ? "RM 0.00"
            : `RM ${rawPrice.toFixed(2)}`;
          content += `<tr><td>${itemId}</td><td>${itemName}</td><td>${formattedPrice}</td><td>Wishlist</td></tr>`;
        });

        checkout.forEach((item) => {
          const itemId = item.getAttribute("id");
          const itemName = item.querySelector("p").textContent.split(" - ")[0];
          const rawPrice = parseFloat(
            item.querySelector("p").textContent.split("RM")[1].trim()
          );
          const formattedPrice = isNaN(rawPrice)
            ? "RM 0.00"
            : `RM ${rawPrice.toFixed(2)}`;
          content += `<tr><td>${itemId}</td><td>${itemName}</td><td>${formattedPrice}</td><td>Checkout</td></tr>`;
        });

        const totalPrice = [...wishlist, ...checkout].reduce((acc, item) => {
          const price = parseFloat(
            item.querySelector("p").textContent.split("RM")[1].trim()
          );
          return acc + (isNaN(price) ? 0 : price);
        }, 0);

        content += `<tr><td colspan="3">Estimated Total Amount</td><td>RM ${totalPrice.toFixed(
          2
        )}</td></tr>`;
        content += "</table>";

        const blob = new Blob([content], { type: "application/msword" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "wishlist_checkout.doc";
        a.click();
        URL.revokeObjectURL(url);
      }

      function toggleMenu() {
        const navbar = document.querySelector(".navbar");
        navbar.classList.toggle("active");
      }
    </script>
  </body>
</html>
